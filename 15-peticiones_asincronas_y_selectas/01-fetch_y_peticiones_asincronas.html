<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  


<!--   PETICIONES ASINCRONAS (FECTH, AJAX) Y SELECTAS  -->

<!--   FETCH Y PETICIONES ASINCRONAS -->

<!-- FETCH ES UN METODO QUE NOS PERMITE HACER PETICIONES AJAX
  UNA PETICION AJAX ES UNA LLAMADA A UN SERVICIO RES, A UN APIRES O A UN BACKEND QUE NOS DEVUELVE UN RESULTADO Y NOSOTROS PODEMOS HACER CON ESE RESULTADO LO QUE QUERAMOS
  VAMOS USAR EL METODO FETCH PARA HACER PETICIONES AJAX Y CONSEGUIR RESULTADOS DESDE UN SERVICIO EXTERNO O DESDE UNA API EXTERNAO DESDE UN BACKEND -->

<!--   VAMOS A UTILIZAR UN SERVICIO DE PRUEBA REST QUE SE LLAMA https://reqres.in/
  CON ESTO VAMOS A PODER SACAR RESULTADOS QUE HAY EN UNA BASE DE DATOS DE PRUEBA EN ESTE SERVICIO
  DESDE JAVASCRIPT PUEDO CONSULTAR ESOS DATOS Y TRAERMELOS A MI FONTEND CON JAVASCRIPT, PODEMOS CONSUMIR UN SERVICIO QUE ESTA EN LA NUBE, UN API QUE ESTA EN LA NUBE O QUE ESTA EN LA PARTE DE BACKEND DE UN PROGRAMA
ESTO ES UN SERVICIO UN BACKEND QUE NOS DEVUELVE DATOS EN JSON
PUEDE RECIBIR PETICIONES POR POST, PUT, GET, DELETE POR ESOS TIPOS DE METODOS DE HTPP Y ES UN SERVICIO QUE VA A RECIBIR UN JSON O UNA INFORMACION Y NOS VA A DEVOLVER OTRA INFORMACION EN JSON Y MEDIANTE ESA APIRES O ESE BACKEND SE VAN A ESTAR GUARDANDO EN LA BASE DE DATOS, SE VAN A ESTAR SACANDO DATOS DE LA BASE DE DATOS Y PARA ESO NORMALMENTE SE HACE UN API  -->




<!-- VEREMOS UN EJEMPLO -->

<!-- NOS CREAREMOS NUESTRO <HTML></HTML> -->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Consumo servicio rest con fetch</title>
</head>

<body>

  <h1>Listado de usuarios</h1>
  <div id="usuarios">
    <span class="loading">Cargando ...</span>
  </div>

  <script src="js/36-fetch.js"></script>
</body>

</html>



<!-- EN NUESTRO JS -->

<!-- FETCH (AJAX)  Y PETICIONES A SERVICIOS / APIS REST 
FETCH (es un sustito del AJAX, es decir es un metodo que hace peticiones AJAX, peticiones asincronas a un servidor) -->
<!-- LO QUE VAMOS HACER NADA MAS CARGAR LA PAGINA HAREMOS UNA PETICION AJAX UTILIZANDO FETCH A LA URL DE LOS USUARIOS PARA QUE NOS LOS LISTE -->

var div_usuarios =document.querySelector("#usuarios");

var usuarios = []; LA VARIABLE LA INICIALIZAMOS PARA QUE SEA UN ARRAY 
fetch('https://reqres.in/api/users')<!--  CON EL METODO fetch RECIBE UNA URL QUE ESCUPA UN JSON Y ESTO ES UNA PROMESA -->
.then(data => data.json())<!-- EN LA PROMESA TENEMOS EL METODO .then Y EN ESTE METODO LO QUE HACEMOS ES RECOGER DATOS. TENEMOS EL PRIMER ELEMENTO .then QUE TIENE UNA FUNCION DE CALLBACK Y ESTA FUNCION DE CALLBACK VA A RECEBIR ESE PARAMETRO DATA Y LO VA A CONVERTIR A JSON TENEMOS UN METODO .json PARA CONVERTIR UN OBJETO QUE NOS LLEGA A JSON DIRECTAMENTE A UN OBJETO DE JAVASCRIPT USABLE -->
.then(users =>{ <!-- LUEGO PODEMOS VOLVER A EJECUTAR EL .then Y RECOGER LA data DE NUEVO Y TENEMOS UNA FUNCION DE CALLBACK -->
  usuarios = users.data; <!-- VAMOS A RECOGER data QUE DENTRO DE data ESTAN LOS USUARIOS (DATA VA A SER EL ARRAY DE TODOS LOS USUARIOS) -->
  usuarios.map((users, i) =>{ <!-- PARA MOSTRAR ESTA INFORMACION DE LOS USUARIOS EN LA PAGINA A PARTE DEL   console.log(usuarios); PODEOS UITILIZAR LA FUNCION foreach O LA FUNCION map RECOGEMOS EN UNA FUNCION DE CALLBACK COMO PARAMETRO LE PASAMOS USERS Y EL INDICE DEL USUARIO(EL ELMENTO DEL ARRAY) -->
    let nombre= document.createElement('h3'); <!-- MOSTRAREMOS TODOS LOS DATOS DEL USUARIO, AVATAR, NOMBRE Y APELLIDOS -->
    nombre.innerHTML = i + " . " + user.first_name + " " + user.last_name;

    div_usuarios.appendChild(nombre);<!--  Y YA NOS APARECE EN LA WEB EL LISTADO DE USUARIOS, DE DONDE SALEN ESTOS USUARIOS DESDE UN SERVICIO REST -->

    document.querySelector(".loading").style.display = 'none';<!--    PODEMOS SELECCIONAR LA CLASE DE LOADING QUE HEMOS CREADO EN NUESTRO HTML Y OCULTARLA UNA VEZ SE HAYAN CARGADO LOS DATOS -->
    
    console.log(usuarios);
});


<!-- fetch('https://reqres.in/api/users') LO QUE HACE ES ACCEDER A UNOS DATOS REMOTOS, HACE LA PETICION SE QUEDA A LA ESPERA DE CUANDO RECIBAMOS ESOS DATOS .then(data => data.json()) LO FORMATEEMOS A JSON
UNA VEZ FORMATEADO LA PROMESA SE QUEDA A LA ESPERA DE OTRO THEN  .then(users =>{ CUANDO TENEMOS LA INFORMACION DE ANTES FORMATEADA LA CAPTURAMOS .then(users =>{ Y YA HACEMOS LO QUE QUERAMOS CON ELLA   usuarios = users.data;
PARA MOSTRAR ESTA INFORMACION DE LOS USUARIOS EN LA PAGINA A PARTE DEL   console.log(usuarios); PODEOS UITILIZAR LA FUNCION foreach O LA FUNCION map-->

<!-- LA FUNCION DE FLECHA => AUTOMATICAMENTE HACE EL RETURN
ESTO .then(data => data.json())
SERIA LO MISMO QUE ESTO 
.then (function(data){
  return data.json()
    }); -->

<!-- ES DECIR LO PRIMERO QUE HACEMOS EN LA PROMESA ES CAPTURAR LOS DATOS (EL DATA) .then(data => data.json())  LO CONVERTIMOS A JSON A UN OBJETO DE JS -->

<!-- Y DESPUES EN LA SEGUNDA YA TENEMOS EN LA VARIABLE DATA TODOS ESOS DATOS RECOGIDOS Y YA DENTRO DE LA VARIABLE USUARIOS LO GUARDAMOS
.then(data =>{
  usuarios = data; 
}); -->

<!-- QUE QUEREMOS GUARDAR DENTRO DE USUARIOS NO QUEREMOS GUARDAR LAS PAGINAS, SIMPLEMENTE NOS INTERESA GUARDAR DATA QUE ES UN ARRAY DE USUARIOS -->

























</body>
</html>